{% extends "layouts/header.html" %}
<span></span>
{% block content %}
<div class="grid-container-1 min-h-screen">
  <header class="w3-container">
    <h1 class="text-style">Search Records</h1>
  </header>

  <div class="warpper">
    <input class="radio" id="one" name="group" type="radio" checked />
    <input class="radio" id="two" name="group" type="radio" />
    <div class="tabs">
      <label class="tab" onclick="switchTab('tab1')" data-tab="tab1" id="one-tab" for="one">View Visitor</label>
      <label class="tab" onclick="switchTab('tab2')" data-tab="tab2" id="two-tab" for="two">Search Visitor</label>
    </div>
    <div class="panels">
      <div class="tab-content">
      <div class="panel" id="tab1">
        <div class="row">
          <div class="col-md-6 offset-md-3">
            <div class="form-group">
              <label for="start-date">Start Date:</label>
              <input type="text" class="form-control" id="start-date" placeholder="mm/dd/yyyy">
            </div>
          </div>
        </div>
        
        <div class="row">
          <div class="col-md-6 offset-md-3">
            <div class="form-group">
              <label for="end-date">End Date:</label>
              <input type="text" class="form-control" id="end-date" placeholder="mm/dd/yyyy">
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-6 offset-md-3">
            <div class="form-group">
              <label for="start-time">Start Time:</label>
              <input type="text" class="form-control" id="start-time" placeholder="hh:mm">
            </div>
          </div>
        </div>
        
        <div class="row">
          <div class="col-md-6 offset-md-3">
            <div class="form-group">
              <label for="end-time">End Time:</label>
              <input type="text" class="form-control" id="end-time" placeholder="hh:mm">
            </div>
          </div>
        </div>
        <div class="d-flex justify-content-center"style="padding-bottom: 1rem;"> 
          <button class="btn btn-primary">Generate</button>
        </div>


        <div class="d-flex justify-content-center">
          <table class="table table-striped table-bordered table-hover">
            <thead class="thead-dark">
              <tr class="text-center">
                <th colspan="5">Generated report from 1/23/23 to 2/23/23 from 6:00am to 7:00pm</th>
              </tr>
            </thead>
            <tbody>
              <tr class="text-center">
                <th>ID Number</th>
                <th>Name</th>
                <th>Department</th>
                <th>Date</th>
                <th>Time visited</th>
              </tr>
              <tr class="text-center">
                <th>201910167</th>
                <th>Regina Mae P. Bulawan</th>
                <th>Computer Studies</th>
                <th>January 1, 2023</th>
                <th>8:00am-9:00pm</th>
              </tr>
            </tbody>
          </table>
        </div>  

      </div>
      <div class="panel" id="tab2">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <div class="form-group">
                  <label for="start-date">Search user: (By ID Number or Last Name)</label>
                  <input type="text" class="form-control" placeholder="ex. CO2019-1-1190" name="search_user" id="user_input" required>
                </div>
            </div>
        </div>

        <div class="d-flex justify-content-center">
          <table id="table-data" class="table table-striped table-bordered table-hover">
            <thead class="thead-dark">
              <tr class="text-center">
                <th>ID Number</th>
                <th>Name</th>
                <th>Department</th>
              </tr>
            </thead>
            <tbody>
              {% for item in users %}
              <tr>
                <td>{{item.user_idno}} &nbsp<i id="icon-eye{{forloop.counter0}}" class="fa fa-eye"></i></td>
                <td>{{item.last_name}}, {{item.firstname|title}} {{item.middle_name}}</td>
                <td>{{item.department.department_name}}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>  
        <div id="content-eye" style="display: none;">
        <div class="d-flex justify-content-center">
          <table class="table table-striped table-bordered table-hover">
            <thead class="thead-dark">
              <tr class="text-center">
                <th>ID Number: 201910167</th>
                <th>Name: Regina Mae P. Bulawan</th>
                <th>Department: Computer Studies</th>
              </tr>
            </thead>
            <tbody>
              <tr class="text-center">
                <th>Date</th>
                <th>Time in</th>
                <th>Time out</th>
              </tr>
              <tr>
                <td>July 1, 2023</td>
                <td>8:00am</td>
                <td>10:00am</td>
              </tr>
            </tbody>
          </table>
        </div>  
      </div>

      </div>
      </div>
    </div>
    </div>
    <script>
    // let currentPage = location.href;
    
    // window.addEventListener("beforeunload", function(event) {
    //   let newPage = location.href;
    //   if (currentPage === newPage) {
    //     sessionStorage.removeItem("activeTab");
    //   }
    // });

  
    document.addEventListener("DOMContentLoaded", function() {
      document.querySelectorAll("[id^='icon-eye']").forEach(function(el) {
          // Add an event listener to each element
          el.addEventListener("click", function() {
                document.querySelector("#content-eye").style.display = 
              document.querySelector("#content-eye").style.display === "none" ? "block" : "none";
          });
          });
        });
    var activeTab = sessionStorage.getItem("activeTabSearch");

    // If there is no active tab, set the first tab as the active tab
    if (!activeTab) {
      activeTab = "tab1";
      document.getElementById("one").checked = true;
      sessionStorage.setItem("activeTabSearch", activeTab);
    }
    if (activeTab == "tab1") {
      document.getElementById("one").checked = true;
    }
    else {
      document.getElementById("two").checked = true;
    }

    // Show the active tab and hide the other tabs
    document.getElementById(activeTab).style.display = "block";
    for (var i = 1; i <= 2; i++) {
      if ("tab" + i != activeTab) {
        document.getElementById("tab" + i).style.display = "none";
      }
    }

    // Function to switch tabs
    function switchTab(tabId) {
      document.getElementById(activeTab).style.display = "none";
      document.getElementById(tabId).style.display = "block";
      activeTab = tabId;
      sessionStorage.setItem("activeTabSearch", activeTab);
    }   
    
    document.getElementById("user_input").addEventListener("input", searchTable);
    if (document.getElementById("user_input").value === "") {
      document.getElementById("table-data").style.display = "none"
    }
       
    function searchTable() {
      document.getElementById("table-data").style.display = ""
      var input, filter, table, tr, td, i, txtValue, td1, txtValue1;
      input = document.getElementById("user_input");
      filter = input.value.toUpperCase();
      table = document.getElementById("table-data");
      tr = table.getElementsByTagName("tr");

      if (filter === '') { // Check if input field is empty
        document.getElementById("table-data").style.display = "none"
      } 
      else {
        for (i = 0; i < tr.length; i++) {
          td = tr[i].getElementsByTagName("td")[0];
          td1 = tr[i].getElementsByTagName("td")[1];
          if (td && td1) {
            txtValue = td.textContent || td.innerText;
            txtValue1 = td1.innerText || td1.textContent;
            if (txtValue.toUpperCase().startsWith(filter) || txtValue1.toUpperCase().startsWith(filter)) {
              tr[i].style.display = "";
            } else {
              tr[i].style.display = "none";
            }
          }
        }
      }
    }

    $(document).ready(function() {
    $('#start-date').datepicker({
        autoclose: true,
        format: 'mm/dd/yyyy',
        startDate: '01/01/2010',
        endDate: '12/31/2022'
    });
    $('#end-date').datepicker({
        autoclose: true,
        format: 'mm/dd/yyyy',
        startDate: '01/01/2010',
        endDate: '12/31/2022'
    });
    });

    $(document).ready(function() {
    $('#start-time').timepicker({
        timeFormat: 'HH:mm',
        interval: 60,
        minTime: '00:00',
        maxTime: '23:59',
        startTime: '00:00',
        dynamic: false,
        dropdown: true,
        scrollbar: true
    });
    $('#end-time').timepicker({
        timeFormat: 'HH:mm',
        interval: 60,
        minTime: '00:00',
        maxTime: '23:59',
        startTime: '00:00',
        dynamic: false,
        dropdown: true,
        scrollbar: true
    });
    });
    </script>
  </div>
  <main class="grid-2-column-2 h-[100%]"> </main>
</div>
{% endblock content %}
