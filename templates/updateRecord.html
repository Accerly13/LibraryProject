{% extends "layouts/header.html" %}
{% block content %}

<style>

textarea {
  width: 100%;
  height: 150px;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
  resize: vertical;
}

  .tab:hover {
  background: #fffffff6;
  color: #336699;
  border-top: 3px solid #336699;
  
}

.btn-cancel {
  background-color: #9f9f9f; /* Blue background */
  border:#9f9f9f solid 1px; /* Remove borders */
  color: white; /* White text */
  cursor: pointer; /* Mouse pointer on hover */
  border-radius: .2em;
  /* width: 50%; */
  /* float: right; */
}

.btn-cancel:hover,
.btn-cancel:focus {
  background-color: #afafaf;
  color: white;
}
</style>

<div class="grid-container-1 min-h-screen">
  <header class="w3-container">
    <h1 class="text-style">Update Records</h1>  
  </header>

  <div class="wrapper">

    {% if messages %}
    <p class="messages">
        {% for message in messages %}
        <p style="color: red; text-align: center; font-weight: bold;" {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message.message }}</p>
        {% endfor %}
    </p>
    {% endif %}

    <input class="radio" id="one" name="group" type="radio" checked>
    <input class="radio" id="two" name="group" type="radio">
    <input class="radio" id="three" name="group" type="radio">
    <input class="radio" id="four" name="group" type="radio">
    <input class="radio" id="five" name="group" type="radio">
    <!-- <div class="flex-tab"> -->

      <div class="tabs flex-tab">
        <label class="tab" onclick="switchTab('tab1')" data-tab="tab1" id="one-tab" for="one">Import Users</label>
        <label class="tab" onclick="switchTab('tab2')" data-tab="tab2" id="two-tab" for="two">Update User</label>
        <label class="tab" onclick="switchTab('tab3')" data-tab="tab3" id="three-tab" for="three">Update College</label>
        <label class="tab" onclick="switchTab('tab4')" data-tab="tab4" id="four-tab" for="four">Update Department</label>
        <label class="tab" onclick="switchTab('tab5')" data-tab="tab5" id="five-tab" for="five">Update User Type</label>
      </div>
    <!-- </div> -->
    <div class="panels panel-relative mx-auto mb-5">
      <div class="panel" id="tab1">
        <div class="flex justify-between items-center mb-5">
          <div class="panel-title">Add New Data</div>
          <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-group">
              <label for="csv_file">Import Users from Previous System:</label>
              <div class="input-group">
                <input type="file" class="form-control-file" id="csv_file" name="csv_file" onchange="showUploadButton()" accept=".csv">
              </div>
            </div>
            <div id="upload-button" style="text-align: center; display: none" class="form-group">
              <button class="btn btn-primary" type="submit">Upload</button>
            </div>
          </form>
        </div>
        <hr>
        <form class="panel-margin" method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="profile-picture">Upload Picture</label>
            <div class="col-sm-10">
              <input type="file" class="form-control" id="profile-picture" accept="image/*" name="picture"/>
            </div>
            <div class="size-image">
              <img id="preview" src="" alt="Preview">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="idnum">ID Number:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="idnum" name="idnum" required>
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="altid">Alternative Number:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="altid" name="altid">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="fname">First name:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="fname" name="fname" required>
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="mname">Middle name:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="mname" name="mname">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="lname">Last name:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="lname" name="lname" required>
            </div>
          </div>
          <div class="row mb-3">
          <label class="col-sm-2 col-form-label" for="gender">Gender:</label>
            <div class="col-sm-10">
              <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                <input type="radio" class="btn-check" id="btnradio1" name="gender" value="M" required>
                <label class="btn btn-outline-primary" for="btnradio1">Male</label>
              
                <input type="radio" class="btn-check" id="btnradio2" name="gender" value="F" required>
                <label class="btn btn-outline-primary" for="btnradio2">Female</label>
              </div>
            </div>
          </div>
          <div class="row mb-3">
          <label class="col-sm-2 col-form-label" for="department">Department:</label>
            <div class="col-sm-10">
                <input class="form-select" autocomplete="off" role="combobox" list="" id="searchinput" name="data_list" placeholder="Search department" required >
                  <datalist id="data_list" role="listbox" style="z-index: 9999; width: 95.5%;">
                    {% for item in dept %}
                      <option value="{{item.department_name}}"> {{ item.department_name }} </option>  
                    {% endfor %}  
                  </datalist>    
            </div>

          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="department">Course:</label>
            <div class="col-sm-10">
              <select class="form-select" aria-label="Default select example" name="courses" onchange="handleSelectChange(this)"> 
                {% if course %}
                  {% for item in course %}
                    {% if item.department.department_name == selected_department %}
                      <option value="{{item.course_name}}"> {{ item.course_name }} </option>
                    {% endif %}
                  {% endfor %}
                  <option value="add-new-course">Add New </option>
                {% else %}
                  <div>
                    <input class="form-control" type="text" id="course" name="courses" required>
                  </div> 
                {% endif %}
              </select>
            </div>
          </div>
          
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="department">User Type:</label>
                <div class="col-sm-10">
                  <select class="form-select" aria-label="Default select example" name="usertype_select">
                    {% for item in usertype %}
                      <option value="{{item.type_id}}"> {{ item.type_name }} </option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="row mb-3">
                <label class="col-sm-2 col-form-label" for="department">Comment:</label>
                  <div class="col-sm-10">
                    <div class="form-floating">
                      <textarea class="form-control" placeholder="Leave a comment here" id="floatingTextarea" name="comments"></textarea>
                      <label for="floatingTextarea">Comments</label>
                    </div>
                  </div>
                </div>
                <div class="d-grid col-3 mx-auto">
                  <button class="btn btn-primary" type="submit">Save</button>
                </div>
        </form>
      </div>
      <div class="panel" id="tab2">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <div class="form-group">
                  <label for="start-date">Search user: (By ID Number or Last Name)</label>
                  <input type="text" class="form-control" placeholder="ex. CO2019-1-1190" name="user_update" id="user_input" required>
                </div>
            </div>
        </div>
        <div id="table-click" class="justify-content-center">
          <table id="table-data" class="table table-bordered table-hover">
            <thead class="thead-dark">
              <tr class="text-center">
                <th>ID Number</th>
                <th>Name</th>
                <th>Department</th>
              </tr>
            </thead>
            <tbody>
              {% for item in users %}
              <tr>
                  <td>{{item.user_idno}}&nbsp<i id="icon-eye{{forloop.counter}}" class="fa fa-eye"></i></i></td>
                  <td>{{item.last_name}}, {{item.firstname|title}} {{item.middle_name}}</td>
                  <td>{{item.department.department_name}}</td>
                  <form id="input_user{{forloop.counter}}" method="post"> 
                    {% csrf_token %}
                    <input type="text" value="{{item.user_idno}}" name="input_user_samp" hidden>
                  </form>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>  

        <div id="content-eye" style="display: none;">
          <div style="display:flex; justify-content: end">
            <button class="btn-delete btn-primary me-md-2" id="myBtn" type="button">Delete</button>
            <form id="delete-user" method="post">
              {% csrf_token %}
              <input type="text" id="confirmation1" name="confirmation1" value="" hidden>
              <input class="form-control" type="text" id="idnum-delete" name="idnum-delete" required hidden>
            </form>
          </div>
          <div id="myModal" class="modal">
            <!-- Modal content -->
            <div class="modal-content">
                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                  <button id="close-modal" type="button" class="btn-close" aria-label="Close"></button>
                </div>
              <div class="confirm-message">Are you sure you want to delete the USER?</div>
              <div class="confirm-actions">
                <button class="btn-delete mr-2 btn-primary" onclick="DeleteRecords()">Yes</button>
        
                <button class="btn btn-primary" id="close-modal" onclick="noButton()">No</button>
              </div>
            </div>
        
          </div>
          <form class="panel-margin" method="post" enctype="multipart/form-data">
            <hr>
            {% csrf_token %}
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="profile-picture1">Upload Picture</label>
              <div class="col-sm-10">
                <input type="file" class="form-control" id="profile-picture1" accept="image/*" name="picture1"/>
              </div>
              <div class="size-image">
                <img id="preview1" src="" alt="Preview">
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="idnum-update">ID Number:</label>
              <div class="col-sm-10">
                <input class="form-control" type="text" id="idnum-update" name="idnum-update" required>
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="alt-id-update">Alternative Number:</label>
              <div class="col-sm-10">
                <input class="form-control" type="text" id="alt-id-update" name="alt-id-update">
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="fname-update">First name:</label>
              <div class="col-sm-10">
                <input class="form-control" type="text" id="fname-update" name="fname-update" required>
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="mname-update">Middle name:</label>
              <div class="col-sm-10">
                <input class="form-control" type="text" id="mname-update" name="mname-update">
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="lname-update">Last name:</label>
              <div class="col-sm-10">
                <input class="form-control" type="text" id="lname-update" name="lname-update" required>
              </div>
            </div>
            <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="gender">Gender:</label>
              <div class="col-sm-10">
                <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                  <input type="radio" class="btn-check" id="btnradio3" name="gender-update" value="M" required>
                  <label class="btn btn-outline-primary" for="btnradio3">Male</label>
          
                  <input type="radio" class="btn-check" id="btnradio4" name="gender-update" value="F" required>
                  <label class="btn btn-outline-primary" for="btnradio4">Female</label>
                </div>
              </div>
            </div>

            
            <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="department">Department:</label>
              <div class="col-sm-10">
                <select class="form-select" aria-label="Default select example" name="data_list1" id="department-list">
                  {% for item in dept %}
                    <option value="{{item.department_name}}"> {{ item.department_name }} </option>
                  {% endfor %}
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="department">Course:</label>
                <div class="col-sm-10">
                  {% if course %}
                  <select class="form-select" aria-label="Default select example" name="courses-update" id="course-select" onchange="handleSelectChange(this)"> 
                    {% for item in course %}
                      <option value="{{item.course_name}}"> {{ item.course_name }} </option>
                    {% endfor %}
                    <option value="add-new-course">Add New </option>
                  </select>
                  {% else %}
                    <div>
                      <input class="form-control" type="text" id="course" name="courses-update" required>
                    </div> 
                  {% endif %}
                </div>
              </div>
              <div class="row mb-3">
                <label class="col-sm-2 col-form-label" for="department">User Type:</label>
                  <div class="col-sm-10">
                    <select id="usertype-select" class="form-select" aria-label="Default select example" name="usertype_select-update">
                      {% for item in usertype %}
                        <option value="{{item.type_id}}"> {{ item.type_name }} </option>
                      {% endfor %}
                    </select>
                  </div>
                </div>
                <div class="row mb-3">
                  <label class="col-sm-2 col-form-label" for="comments-update">Comment:</label>
                    <div class="col-sm-10">
                      <div class="form-floating">
                        <textarea class="form-control" placeholder="Leave a comment here" id="comments-update" name="comments-update"></textarea>
                        <label for="comments-update">Comments</label>
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="d-grid col-3 mx-auto">
                      <button class="btn-cancel">Cancel</button>
                    </div>
                    <div class="d-grid col-3 mx-auto">
                      <button class="btn btn-primary" type="submit">Save</button>
                    </div>
                  </div>
          </form>
        </div>     
      </div>
      <div class="panel" id="tab3">
        <!-- <div class="panel-title">Note on Prerequisites</div> -->
        <div id="myModalCollege" class="modal">
          <!-- Modal content -->
          <div class="modal-content">
              <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <button id="close-modal" type="button" class="btn-close" aria-label="Close" onclick="noButtonCollege()"></button>
              </div>
            <div class="confirm-message-college">
            </div>
            <div class="confirm-actions">
              <button class="btn-delete mr-2 btn-primary" onclick="DeleteCollege()">Yes</button>
      
              <button class="btn btn-primary" id="close-modal" onclick="noButtonCollege()">No</button>
            </div>
          </div>
        </div>
        <div class="flex justify-between items-center mb-5">
          <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-group">
              <label for="csv_file1">Import Colleges from Previous System:</label>
              <div class="input-group">
                <input type="file" class="form-control-file" id="csv_file1" name="csv_file1" onchange="showUploadButton1()" accept=".csv">
              </div>
            </div>
            <div id="upload-button1" style="text-align: center; display: none" class="form-group">
              <button class="btn btn-primary" type="submit">Upload</button>
            </div>
          </form>
        </div>
        <hr  style="margin-bottom: 3rem">

        <div class="row mb-3">
          <form action="/admin/dashboard/updaterecord/" method="post" name="add_college_form">
            {% csrf_token %}
<<<<<<< HEAD
            <div class="input-group">
              <label class="col-sm-2 col-form-label" for="college">Add a College/s:</label>
              <form method="POST">
                {% csrf_token %}
                <textarea id="text-input" name="colleges-inputs" placeholder="Enter Colleges you want to add" class="form-control"></textarea>
                <button class="btn-update btn-outline-secondary" type="submit">Add</button>
              </form>
            </div>
             
=======
          <div class="input-group">
            <label class="col-sm-2 col-form-label" for="college">Add a College/s:</label>
                          <form method="POST">
                            {% csrf_token %}
                            <textarea id="text-input" name="colleges-inputs" placeholder="Enter Colleges you want to add" required></textarea>
                            <button class="btn-update btn-outline-secondary" type="submit">Add</button>
                          </form>
            <!-- <input type="text" class="form-control" value="College of " aria-label="College of" aria-describedby="basic-addon2" name="college" required> -->
            <!-- <div class="input-group-button">
              <button class="btn-update btn-outline-secondary" type="submit">Add</button>
            </div> -->
          </div>   
>>>>>>> e4ac1f3dcc223cf3a64531f8e68a349d7866e798
          </form>  
        </div>
        <form method="post" name="update_college_form"> 
          {% csrf_token %}
          <div class="row mb-3">
            <div class="input-group">
            <label class="col-sm-2 col-form-label" for="department">Update a College:</label>
              <select class="form-select" aria-label="Default select example" name="college_name" onchange="updateCollegeName()">
                {% for item in data %}
                  <option value="{{item.college_name}}" new-college-name="{{item.college_name}}"> {{ item.college_name }} </option>
                {% endfor %}
              </select>
            </div>
          </div>
          <!-- <div class="row mb-3">
            <div class="input-group">
              <label class="col-sm-2 col-form-label" for="fname">New College Name:</label>
              <input type="text" class="form-control" value="College of " aria-label="College of" aria-describedby="basic-addon2" name="new_college_name" required>
              <div class="input-group-button">
                <button class="btn-update btn-outline-secondary" type="submit">Update</button>
              </div>
            </div>     
          </div> -->
          <div class="row mb-3">
            <div class="col"></div>
            <div class="col-sm-10">
              <div class="input-group" id="new-college" style="display: none;">
                <input type="text" class="form-control" value="College of " aria-label="College of"
                  aria-describedby="basic-addon2" name="new_college_name" style="width: 80%" required>
                <div class="input-group-button float-end">
                  <button class="btn-update btn-outline-secondary" type="submit">Update</button>
                </div>
              </div>
            </div>
          </div>
        </form>
        <form method="post" id="delete-college">
          {% csrf_token %}
        <div class="row mb-3">
            <div class="input-group">
              <input type="text" id="confirmation-college" name="confirmation-college" value="" hidden>
              <label class="col-sm-2 col-form-label" for="delete_college">Delete a College:</label>
              <select class="custom-select" id="delete_college" name="delete_college">
                {% for item in data %}
                  <option value="{{item.college_name}}"> {{ item.college_name }} </option>
                {% endfor %}
              </select>
              <div class="input-group-button">
                <button class="btn-delete btn-primary me-md-2" id="myBtnCollege" type="button">Delete</button>
              </div>
          </div>
        </div>
        </form>
        </div>
   
      <div class="panel" id="tab4">
        <!-- <div class="panel-title">Note on Prerequisites</div> -->
        <div id="myModalDepartment" class="modal">
          <!-- Modal content -->
          <div class="modal-content">
              <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <button id="close-modal" type="button" class="btn-close" aria-label="Close" onclick="noButtonDepartment()"></button>
              </div>
            <div class="confirm-message-department">
            </div>
            <div class="confirm-actions">
              <button class="btn-delete mr-2 btn-primary" onclick="DeleteDepartment()">Yes</button>
      
              <button class="btn btn-primary" id="close-modal" onclick="noButtonDepartment()">No</button>
            </div>
          </div>
        </div>
        <form method="POST" enctype="multipart/form-data" style="margin-bottom: 3rem">
          {% csrf_token %}
          <div class="form-group">
            <label for="csv_file2">Import Departments Data from Previous System:</label>
            <div class="input-group">
              <input type="file" class="form-control-file" id="csv_file2" name="csv_file2" onchange="showUploadButton2()" accept=".csv">
            </div>
          </div>
          <div id="upload-button2" style="text-align: center; display: none" class="form-group">
            <button class="btn btn-primary" type="submit">Upload</button>
          </div>
        </form>
        <hr style="margin-bottom: 3rem">

        <form method="post">
          {% csrf_token %}

          <div class="row mb-3">
            <div class="input-group">
              <label class="col-sm-2 col-form-label" for="dept">Add departments manually:</label>
              <!-- <div class="col-sm-10"> -->
                <select class="form-select" aria-label="Default select example" name="from_college" onchange="showInputField()">
                  {% for item in data %}
                    <option value="{{item.college_name}}" data-college="{{item.college_name}}">{{ item.college_name }}</option>
                  {% endfor %}
                </select>
                
                <!-- </div> -->
              </div>   
          </div>
          <div class="row mb-3">
            <div class="col"></div>
              <div class="col-sm-10">
                <div id="college-department" style="display: none;">
                  <textarea placeholder="Enter the department or departments you want to add:" class="form-control" id="text-input"
                  id="text-input" name="department-inputs" required></textarea>
                <div class="input-group-button pt-2 float-end">
                  <button class="btn-update btn-outline-secondary text-center" style="width: 80px">Add</button>
                </div>
              </div>
          </div>
          </div>
        </form>
        <form method="post"> 
          {% csrf_token %}
        <div class="row mb-3">
          <div class="input-group">
            <label class="col-sm-2 col-form-label" for="department">Update a Department:</label>
              <select class="form-select" aria-label="Default select example" name="update_dept_form" onchange="updateDepartmentName()">
                {% for item in dept %}
                  <option value="{{item.department_name}}" data-department="{{item.department_name}}"> {{ item.department_name }} </option>
                {% endfor %}
              </select>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col"></div>
            <div class="col-sm-10">
              <div class="input-group" id="new-department" style="display: none;">
                <input type="text" class="form-control" value="Department of " aria-label="Department of" aria-describedby="basic-addon2" name="new_dept_name" style="width: 80%"required>
                  <div class="input-group-button float-end">
                    <button class="btn-update btn-outline-secondary" type="submit">Update</button>
                  </div>
              </div>   
            </div>  
          </div>
      </form>
      <form method="post" id="delete-department">
        {% csrf_token %}
        <div class="row mb-3">
          <div class="input-group">
            <input type="text" id="confirmation-department" name="confirmation-department" value="" hidden>
            <label class="col-sm-2 col-form-label" for="delete_dept">Delete a Department:</label>
            <select class="custom-select" id="inputGroupSelect04" name="delete_dept">
              {% for item in dept %}
                <option value="{{item.department_name}}"> {{ item.department_name }} </option>
              {% endfor %}
            </select>
            <div class="input-group-button">
              <button class="btn-delete btn-outline-secondary" id="myBtnDepartment" type="button">Delete</button>
            </div>
          </div>
          </div>
        </form>
        </div>
      
      <div class="panel" id="tab5">
        <!-- <div class="panel-title">Note on Prerequisites</div> -->
        <form method="post">
        {% csrf_token %}
          <div class="row mb-3">
            <div class="input-group">
              <label class="col-sm-2 col-form-label" for="fname">Add User Type</label>
              <input type="text" class="form-control" placeholder="" aria-label="College of" aria-describedby="basic-addon2" name="usertype" required autocomplete="off">
              <div class="input-group-button">
                <button class="btn-update btn-outline-secondary" type="submit">Add</button>
              </div>
            </div>     
          </div>
        </form>
        <div class="d-flex justify-content-center">
          <table class="table table-striped table-bordered table-hover">
            <thead class="thead-dark">
              <tr class="text-center">
                <th>User ID</th>
                <th>User Type</th>
              </tr>
            </thead>
            <tbody>
              {% for item in usertype %}
              <tr>
                <td>{{item.type_id}}</td>
                <td>{{item.type_name}}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>        
      </div>
      </div>
    </div>

<style>
  .confirm-btn {
  padding: 10px 20px;
  font-size: 16px;
  border-radius: 5px;
  border: none;
  cursor: pointer;
  background-color: #007bff;
  color: white;
  }

  .confirm-popup {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: white;
  box-shadow: 0 0 10px #ccc;
  padding: 20px;
  }

  .confirm-message {
  font-size: 18px;
  margin-bottom: 20px;
  text-align: center;
  font-weight: bold;
  }

  .confirm-message-college {
  font-size: 18px;
  margin-bottom: 20px;
  text-align: center;
  font-weight: bold;
  color: red;
  }

  .confirm-message-department {
  font-size: 18px;
  margin-bottom: 20px;
  text-align: center;
  font-weight: bold;
  color: red;
  }
  .confirm-actions {
  display: flex;
  justify-content: center;
  text-align: center;
  }


  .confirm-yes {
  padding: 10px 20px;
  font-size: 16px;
  border-radius: 5px;
  border: none;
  cursor: pointer;
  background-color: green;
  color: white;
  }

  .confirm-no {
  padding: 10px 20px;
  font-size: 16px;
  border-radius: 5px;
  border: none;
  cursor: pointer;
  background-color: red;
  color: white;
  }

  /* The Modal (background) */
  .modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
  backdrop-filter: blur(2px);
  }

  /* Modal Content */
  .modal-content {
  background-color: #fefefe;
  margin: 15% auto; /* 15% from the top and centered */
  padding: 20px;
  border: 1px solid #888;
  width: 40%; /* Could be more or less, depending on screen size */
  }



  /* The Close Button */
  /* The Close Button */
  .close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
  }


  .close:hover,
  .close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
  }

  
fieldset {
  border: 1px solid blue;
  width: 360px;
  border-radius: 5px;
}

legend{
  color: blue; 
  font-size: 24px;
  font-family: sans-serif;
}

.search-input {
  font-size: 18px;
  padding: 5px;
  height: 35px;
  width: 350px;
  border: 1px solid blue;
  outline: none;
  border-radius: 5px;
  color: black;
/*   border-bottom: none; */
}
datalist {
  position: absolute;
  background-color: white;
  border: .5px solid rgb(128, 128, 128);
  border-radius: 0 0 5px 5px;
  border-top: none;
  font-family: sans-serif;
  width: 350px;
  padding: 5px;
  max-height: 10rem;
  overflow-y: auto
  
}

option {
  background-color: white;
  padding: 4px;
  color: black;
  margin-bottom: 1px;
   font-size: 18px;
  cursor: pointer;
}

option:hover,  .active{
  background-color: rgb(225, 225, 225);
}

  #preview {
    display: none;
  }

  .size-image img {
  width: 120px;
  height: 120px;
}

</style>

<script>
sessionStorage?.removeItem("activeTabSearch");
sessionStorage?.removeItem("activeTabManageReport");

function showInputField() {
  var select = document.querySelector('select[name="from_college"]');
  var collegeName = select.options[select.selectedIndex].getAttribute('data-college');
  var collegeDepartment = document.querySelector('#college-department');
  
  if (collegeName) {
    collegeDepartment.style.display = "block";
    collegeDepartment.querySelector('label').innerText = collegeName + " Department:";
  } else {
    collegeDepartment.style.display = "none";
  }
}

  function updateDepartmentName() {
    var select = document.querySelector('select[name="update_dept_form"]');
    var departmentName = select.options[select.selectedIndex].getAttribute('data-department');
    var newDepartmentName = document.querySelector('#new-department');

    if (departmentName) {
      newDepartmentName.style.display = "block";
      newDepartmentName.querySelector('label').innerText = departmentName + " Department:";
    } else {
      newDepartmentName.style.display = "none";
    }
  }

  function updateCollegeName() {
      var select = document.querySelector('select[name="college_name"]');
      var updateCollege = select.options[select.selectedIndex].getAttribute('new-college-name');
      var newCollegeName = document.querySelector('#new-college');

      if (updateCollege) {
        newCollegeName.style.display = "block";
        newCollegeName.querySelector('label').innerText = updateCollege + " Department:";
      } else {
        newCollegeName.style.display = "none";
      }
    }


function showUploadButton() {
  var fileInput = document.getElementById('csv_file');
  var uploadButton = document.getElementById('upload-button');
  if (fileInput.files && fileInput.files.length > 0) {
    uploadButton.style.display = 'block';
  }
}

function showUploadButton1() {
  var fileInput = document.getElementById('csv_file1');
  var uploadButton = document.getElementById('upload-button1');
  if (fileInput.files && fileInput.files.length > 0) {
    uploadButton.style.display = 'block';
  }
}

function showUploadButton2() {
  var fileInput = document.getElementById('csv_file2');
  var uploadButton = document.getElementById('upload-button2');
  if (fileInput.files && fileInput.files.length > 0) {
    uploadButton.style.display = 'block';
  }
}

var fileInput = document.getElementById("profile-picture");
var previewImg = document.getElementById("preview");
fileInput.addEventListener("change", function() {
  // Get the selected file
  var file = fileInput.files[0];

  // Check if a file was selected
  if (file) {
    // Create a FileReader object
    var reader = new FileReader();

    // Set the callback function for when the file is loaded
    reader.onload = function(e) {
      // Set the src attribute of the preview image to the data URL
      previewImg.src = e.target.result;

      // Show the preview image
      previewImg.style.display = "block";
    }

    // Read the contents of the file as a data URL
    reader.readAsDataURL(file);
  } else {
    // Hide the preview image
    previewImg.style.display = "none";
  }
});


var fileInput1 = document.getElementById("profile-picture1");
var previewImg1 = document.getElementById("preview1");
fileInput1.addEventListener("change", function() {
  // Get the selected file
  var file = fileInput1.files[0];

  // Check if a file was selected
  if (file) {
    // Create a FileReader object
    var reader = new FileReader();

    // Set the callback function for when the file is loaded
    reader.onload = function(e) {
      // Set the src attribute of the preview image to the data URL
      previewImg1.src = e.target.result;

      // Show the preview image
      previewImg1.style.display = "block";
    }

    // Read the contents of the file as a data URL
    reader.readAsDataURL(file);
  } else {
    // Hide the preview image
    previewImg1.style.display = "none";
  }
});

document.addEventListener("DOMContentLoaded", function() {
      document.querySelectorAll("[id^='icon-eye']").forEach(function(el) {
          // Add an event listener to each element
          el.addEventListener("click", function(event) {
            document.querySelector("#table-click").style.display = "none"
            var table, tr, td;
            table = document.getElementById("table-data");
            tr = table.getElementsByTagName("tr");
            stringReplace = el.id.replace("icon-eye", "")
            event.preventDefault();
            var myForm = document.querySelector('#input_user'+stringReplace);
            var formData = new FormData(myForm);
            fetch('/admin/dashboard/updaterecord/', {
              method: 'POST',
              body: formData
            }).then(response => response.json())
            .then(data => {
              var userId = document.querySelector('#idnum-update');
              // const altId = document.querySelector('#alt-id-update');
              var nameInput = document.querySelector('#fname-update');
              var middleName = document.querySelector('#mname-update');
              var lastName = document.querySelector('#lname-update');

              var comment = document.querySelector('#comments-update');
              var altid_update = document.querySelector('#alt-id-update');

              var select = document.getElementById("department-list");
              for (var i = 0; i < select.options.length; i++) {
                var option = select.options[i];

                // If the option value matches the selected value, set the selected attribute
                if (option.value === data.department) {
                  option.selected = true;
                }
              }

              var select1 = document.getElementById("course-select");
              for (var i = 0; i < select1.options.length; i++) {
                var option = select1.options[i];

                // If the option value matches the selected value, set the selected attribute
                if (option.value === data.user_searched.course) {
                  option.selected = true;
                }
              }

              var select2 = document.getElementById("usertype-select");
              for (var i = 0; i < select2.options.length; i++) {
                var option = select2.options[i];
                // If the option value matches the selected value, set the selected attribute
                if (option.value == data.usertype) {
                  option.selected = true;
                }
              }

              var radios = document.getElementsByName("gender-update");
              for (var i = 0; i < radios.length; i++) {
                var radio = radios[i];

                // If the radio button value matches the selected value, set the checked attribute
                if (radio.value === data.user_searched.gender) {
                  radio.checked = true;
                }
              }
              var img = document.getElementById("preview1");

              // Set the src attribute
              img.src = data.image_url
              
              comment.value = data.user_searched.comment
              altid_update.value = data.user_searched.alternative_id
              userId.value = data.user_searched.user_idno;
              nameInput.value = data.user_searched.first_name;
              middleName.value = data.user_searched.middle_name;
              lastName.value = data.user_searched.last_name;

            })
            var td_show = tr[stringReplace].getElementsByTagName("td")[0];
            var td_show1 = tr[stringReplace].getElementsByTagName("td")[1];
            var td_show2 = tr[stringReplace].getElementsByTagName("td")[2];
            document.querySelector("#content-eye").style.display = 
            document.querySelector("#content-eye").style.display === "none" ? "block" : "none";
          });
      });
    });

var activeTab = sessionStorage.getItem("activeTab");

    // If there is no active tab, set the first tab as the active tab
    if (!activeTab) {
      activeTab = "tab1";
      document.getElementById("one").checked = true;
      sessionStorage.setItem("activeTab", activeTab);
    }
    if (activeTab == "tab1") {
      document.getElementById("one").checked = true;
    
    }else if (activeTab == "tab2"){ 
      document.getElementById("two").checked = true;
    
    }else if (activeTab == "tab3"){ 
      document.getElementById("three").checked = true;
 
    }else if (activeTab == "tab4"){ 
      document.getElementById("four").checked = true;
    
    }else {
      document.getElementById("five").checked = true;
    }

    // Show the active tab and hide the other tabs
    document.getElementById(activeTab).style.display = "block";
    for (var i = 1; i <= 5; i++) {
      if ("tab" + i != activeTab) {
        document.getElementById("tab" + i).style.display = "none";
      }
    }

    // Function to switch tabs
    function switchTab(tabId) {
      var collegeDepartment = document.querySelector('#college-department');
      collegeDepartment.style.display = "none";

      var newDepartmentName = document.querySelector('#new-department');
      newDepartmentName.style.display = "none";

      var newCollegeName = document.querySelector('#new-college');
      newCollegeName.style.display = "none";

      document.getElementById(activeTab).style.display = "none";
      document.getElementById(tabId).style.display = "block";
      activeTab = tabId;
      sessionStorage.setItem("activeTab", activeTab);
    }


  var closeModalBtn = document.getElementById("close-modal");
    closeModalBtn.addEventListener("click", function() {
      var modalContainer = document.querySelector(".modal");
      modalContainer.style.display = "none";
  });
document.getElementById("user_input").addEventListener("input", searchTable);
if (document.getElementById("user_input").value === "") {
      document.getElementById("table-data").style.display = "none"
    }

function searchTable() {
  $("#table-data-show tbody tr").remove(); 
      document.querySelector("#table-click").style.display = ""
      document.querySelector("#content-eye").style.display = "none"

  document.getElementById("table-data").style.display = ""
  var input, filter, table, tr, td, i, txtValue, td1, txtValue1;
      input = document.getElementById("user_input");
      filter = input.value.toUpperCase().replace(/[^a-z0-9]/gi, "");
      table = document.getElementById("table-data");
      tr = table.getElementsByTagName("tr");
      if (filter === '') { // Check if input field is empty
        document.getElementById("table-data").style.display = "none"
      } 
      else {
        for (i = 0; i < tr.length; i++) {
          td = tr[i].getElementsByTagName("td")[0];
          td1 = tr[i].getElementsByTagName("td")[1];
          if (td && td1) {
            txtValue = td.textContent.replace(/[^a-z0-9]/gi, "") || td.innerText.replace(/[^a-z0-9]/gi, "");
            txtValue1 = td1.innerText.replace(/[^a-z0-9]/gi, "") || td1.textContent.replace(/[^a-z0-9]/gi, "");
            if (txtValue.toUpperCase().replace(/[^a-z0-9]/gi, "").startsWith(filter) || txtValue1.toUpperCase().replace(/[^a-z0-9]/gi, "").startsWith(filter)) {
              tr[i].style.display = "";
            } else {
              tr[i].style.display = "none";
            }
          }
        }
    }
  }
  

  function handleSelectChange(select) {
  if (select.value === "add-new-course") {
    var input = document.createElement("input");
    input.type = "text";
    input.placeholder = "Enter new course";
    input.onblur = function() {
      if (input.value) {
        var option = document.createElement("option");
        option.text = input.value;
        option.value = input.value;
        select.add(option, select.options[select.options.length - 1]);
        input.remove();
        select.value = option.value;
      } else {
        input.remove();
        select.value = "";
      }
    };
    select.after(input);
    input.focus();
  }
}

  searchinput.onfocus = function () {
  data_list.style.display = 'block';
  searchinput.style.borderRadius = "5px 5px 0 0";  
};
for (let option of data_list.options) {
  option.onclick = function () {
    searchinput.value = option.value;
    data_list.style.display = 'none';
    searchinput.style.borderRadius = "5px";
  }
};

searchinput.oninput = function() {
  currentFocus = -1;
  var text = searchinput.value.toUpperCase();
  for (let option of data_list.options) {
    if(option.value.toUpperCase().indexOf(text) > -1){
      option.style.display = "block";
  }else{
    option.style.display = "none";
    }
  };
}

var datalist = document.getElementById('data_list');
var input = document.getElementById('searchinput');

document.addEventListener('click', (event) => {
  const target = event.target;
  
  // if the click target is not the input or an option in the datalist, hide the datalist
  if (target !== input && !datalist.contains(target)) {
    datalist.style.display = 'none';
  }
});

input.addEventListener('focus', () => {
  datalist.style.display = 'block';
});

var currentFocus = -1;
searchinput.onkeydown = function(e) {
  if(e.keyCode == 40){
    currentFocus++
   addActive(data_list.options);
  }
  else if(e.keyCode == 38){
    currentFocus--
   addActive(data_list.options);
  }
  else if(e.keyCode == 13){
    e.preventDefault();
        if (currentFocus > -1) {
          /*and simulate a click on the "active" item:*/
          if (data_list.options) data_list.options[currentFocus].click();
        }
  }
}

function addActive(x) {
    if (!x) return false;
    removeActive(x);
    if (currentFocus >= x.length) currentFocus = 0;
    if (currentFocus < 0) currentFocus = (x.length - 1);
    x[currentFocus].classList.add("active");
  }
  function removeActive(x) {
    for (var i = 0; i < x.length; i++) {
      x[i].classList.remove("active");
    }
  }

   // Get the modal
  var modal = document.getElementById("myModal");
  
  // Get the button that opens the modal
  var btn = document.getElementById("myBtn");
  
  // Get the <span> element that closes the modal
  
  // When the user clicks the button, open the modal 
  btn.onclick = function() {
    document.getElementById("idnum-delete").value = document.getElementById("idnum-update").value
    modal.style.display = "block";
  }
  
  // When the user clicks on <span> (x), close the modal

  
  // When the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = "none";
    }
  }
  function noButton() {
    modal.style.display = "none";
    event.preventDefault()
  }

  function DeleteRecords() {
    document.getElementById("confirmation1").value = "Yes"
    event.preventDefault();
      var myForm = document.querySelector('#delete-user');
      var formData = new FormData(myForm);
      fetch('/admin/dashboard/updaterecord/', {
        method: 'POST',
        body: formData
      }).then(
        window.location.reload()
      )
  }
  var modalCollege = document.getElementById("myModalCollege");
  
  // Get the button that opens the modal
  var btnCollege = document.getElementById("myBtnCollege");
  
  // Get the <span> element that closes the modal
  
  // When the user clicks the button, open the modal 
  btnCollege.onclick = function() {
    event.preventDefault();
    var myForm = document.querySelector('#delete-college');
    var formData = new FormData(myForm);
    fetch('/admin/dashboard/updaterecord/', {
      method: 'POST',
      body: formData
    }).then(response => response.json())
      .then(data => {
        var ulElement = document.createElement('ul');
        var jsResponse = data.departments_of_this_college;
        var confirmMessageElement = document.querySelector('.confirm-message-college');
        if (jsResponse.departments.length > 0) {
          confirmMessageElement.innerHTML = 'Note that this college has departments:<ul>';
          for (let i = 0; i < jsResponse.departments.length; i++) {
            confirmMessageElement.innerHTML += '<li style="font-size:14px; color:black; text-align:left">' + jsResponse.departments[i].department_name + '</li>'
          }
          confirmMessageElement.innerHTML += '</ul>Deleting this college will also delete these departments in the database as well as the users in these departments.';
        }
        else {
          confirmMessageElement.innerHTML = 'Delete ' + data.college_delete + '?'
        }
        modalCollege.style.display = "block";
      });
  }

  function noButtonCollege() {
    modalCollege.style.display = "none";
    event.preventDefault()
  }
  function DeleteCollege() {
    document.getElementById("confirmation-college").value = "Yes"
    event.preventDefault();
      var myForm = document.querySelector('#delete-college');
      var formData = new FormData(myForm);
      fetch('/admin/dashboard/updaterecord/', {
        method: 'POST',
        body: formData
      }).then(
        window.location.reload()
      )
  }

  var modalDepartment = document.getElementById("myModalDepartment");
  
  // Get the button that opens the modal
  var btnDepartment = document.getElementById("myBtnDepartment");
  
  // Get the <span> element that closes the modal
  
  // When the user clicks the button, open the modal 
  btnDepartment.onclick = function() {
    event.preventDefault();
      var myForm = document.querySelector('#delete-department');
      var formData = new FormData(myForm);
      fetch('/admin/dashboard/updaterecord/', {
        method: 'POST',
        body: formData
      }).then(response => response.json())
            .then(data => {
              var jsResponse = data.users_in_this_department
              var confirmMessageElement = document.querySelector('.confirm-message-department');
              if (jsResponse.users.length > 0) {
                confirmMessageElement.textContent = 'Note that this department has ' + jsResponse.users.length + ' users. Deleting this department will also delete the users in these department.';
              }
              else {
                confirmMessageElement.innerHTML = 'Delete ' + data.department_delete + '?'
              }
              modalDepartment.style.display = "block";
      })
      
  }
  function noButtonDepartment() {
    modalDepartment.style.display = "none";
    event.preventDefault()
  }
  function DeleteDepartment() {
    document.getElementById("confirmation-department").value = "Yes"
    event.preventDefault();
      var myForm = document.querySelector('#delete-department');
      var formData = new FormData(myForm);
      fetch('/admin/dashboard/updaterecord/', {
        method: 'POST',
        body: formData
      }).then(
        window.location.reload()
      )
  }
    
    // Get the button that opens the modal
    
    // Get the <span> element that closes the modal
    
    // When the user clicks the button, open the modal 
 
</script>
</div>
{% endblock content %}