{% extends "layouts/header.html" %}
{% block content %}

<style>

fieldset {
  border: 1px solid blue;
  width: 360px;
  border-radius: 5px;
}

legend{
  color: blue; 
  font-size: 24px;
  font-family: sans-serif;
}

.search-input {
  font-size: 18px;
  padding: 5px;
  height: 35px;
  width: 350px;
  border: 1px solid blue;
  outline: none;
  border-radius: 5px;
  color: black;
/*   border-bottom: none; */
}
datalist {
  position: absolute;
  background-color: white;
  border: .5px solid rgb(128, 128, 128);
  border-radius: 0 0 5px 5px;
  border-top: none;
  font-family: sans-serif;
  width: 350px;
  padding: 5px;
  max-height: 10rem;
  overflow-y: auto
  
}

option {
  background-color: white;
  padding: 4px;
  color: black;
  margin-bottom: 1px;
   font-size: 18px;
  cursor: pointer;
}

option:hover,  .active{
  background-color: rgb(225, 225, 225);
}

</style>

<div class="grid-container-1 min-h-screen">
  <header class="w3-container">
    <h1 class="text-style">Update Records</h1>  
  </header>

  <div class="wrapper">
    <input class="radio" id="one" name="group" type="radio" checked>
    <input class="radio" id="two" name="group" type="radio">
    <input class="radio" id="three" name="group" type="radio">
    <input class="radio" id="four" name="group" type="radio">
    <input class="radio" id="five" name="group" type="radio">
    <!-- <div class="flex-tab"> -->
      <div class="tabs flex-tab">
          <label class="tab" id="one-tab" for="one">Import Users</label>
          <label class="tab" id="two-tab" for="two">Update User</label>
          <label class="tab" id="three-tab" for="three">Update College</label>
          <label class="tab" id="four-tab" for="four">Update Department</label>
          <label class="tab" id="five-tab" for="five">Update User Type</label>
        </div>
    <!-- </div> -->
    <div class="panels panel-relative mx-auto mb-5">
      <div class="panel" id="one-panel">
        <div class="flex justify-between items-center mb-5">
          <div class="panel-title">Add New Data</div>
          <div class="d-grid-md-flex justify-content-md-end">
           
            <button class="btn btn-primary me-md-2" type="button">Batch Upload</button>
            
          </div>
        </div>
        <hr>
        <form class="panel-margin" method="post">
          {% csrf_token %}
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="customFile">Upload Picture</label>
            <div class="col-sm-10">
              <input type="file" class="form-control" id="customFile" />
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="idnum">ID Number:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="idnum" name="idnum">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="idnum">Alternative Number:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="altid" name="altid">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="fname">First name:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="fname" name="fname">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="mname">Middle name:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="mname" name="mname">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="lname">Last name:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="lname" name="lname">
            </div>
          </div>
          <div class="row mb-3">
          <label class="col-sm-2 col-form-label" for="gender">Gender:</label>
            <div class="col-sm-10">
              <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                <input type="radio" class="btn-check" id="btnradio1" name="gender" value="M">
                <label class="btn btn-outline-primary" for="btnradio1">Male</label>
              
                <input type="radio" class="btn-check" id="btnradio2" name="gender" value="F">
                <label class="btn btn-outline-primary" for="btnradio2">Female</label>
              </div>
            </div>
          </div>
          <div class="row mb-3">
          <label class="col-sm-2 col-form-label" for="department">Department:</label>
            <!-- <div class="col-sm-10">
              <select class="form-select" aria-label="Default select example" name="department_select">
                {% for item in dept %}
                  <option value="{{item.department_name}}"> {{ item.department_name }} </option>
                {% endfor %}
              </select>
            </div> -->

            <div class="col-sm-10">
              <fieldset>
                <input class="form-select" autocomplete="off" role="combobox" list="" id="searchinput" name="department_select" placeholder="Search department">
                <datalist id="department_select" role="listbox">
                  <option value="Internet Explorer">Internet Explorer</option>
                  {% for item in dept %}
                  <option value="{{item.department_name}}"> {{ item.department_name }} </option>  
                  {% endfor %}  
                  </datalist>    
              </fieldset>
              </div>

          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="department">Course:</label>
              <div class="col-sm-10">
                {% if course %}
                <select class="form-select" aria-label="Default select example" name="courses" onclick="checkAndAddOption(this)"> 
                  {% for item in course %}
                    <option value="{{item.course_name}}"> {{ item.course_name }} </option>
                    <option onclick="checkAndAddOption(this)" value="">Add New </option>
                  {% endfor %}
                </select>
                <div id="inputnew"></div> 
                {% else %}
                  <div>
                    <input class="form-control" type="text" id="course" name="courses">
                  </div> 
                {% endif %}
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="department">User Type:</label>
                <div class="col-sm-10">
                  <select class="form-select" aria-label="Default select example" name="usertype_select">
                    {% for item in usertype %}
                      <option value="{{item.type_id}}"> {{ item.type_name }} </option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="row mb-3">
                <label class="col-sm-2 col-form-label" for="department">Comment:</label>
                  <div class="col-sm-10">
                    <div class="form-floating">
                      <textarea class="form-control" placeholder="Leave a comment here" id="floatingTextarea" name="comments"></textarea>
                      <label for="floatingTextarea">Comments</label>
                    </div>
                  </div>
                </div>
                <div class="d-grid col-4 mx-auto">
                  <button class="btn btn-primary" type="submit">Save</button>
                </div>
        </form>
      </div>
      <div class="panel" id="two-panel">
        <div class="row">
          <div class="col-md-6 offset-md-3">
              <div class="form-group">
                <label for="start-date">Search user: (By ID Number or Last Name)</label>
                <input type="text" class="form-control" placeholder="ex. CO2019-1-1190" name="user_update" id="user_input">
              </div>
          </div>
        </div>

        <div class="d-flex justify-content-center">
          <table class="table table-striped table-bordered table-hover">
            <thead class="thead-dark">
              <tr class="text-center">
                <th>ID Number</th>
                <th>Name</th>
                <th>Department</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                {% for item in users %}
                  <td>{{item.user_idno}}&nbsp<i class="fa fa-eye"></i></td>
                  <td>{{item.first_name}} {{item.middle_name}} {{item.last_name}}</td>
                  <td>Computer Studies</td>
                {% endfor %}
              </tr>
            </tbody>
          </table>
        </div>  

        <form class="panel-margin" method="post">

          <div style="display:flex; justify-content: end">
            <button class="btn-delete btn-primary me-md-2" type="button">Delete</button>
          </div>

          <hr>
          {% csrf_token %}
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="customFile">Upload Picture</label>
            <div class="col-sm-10">
              <input type="file" class="form-control" id="customFile" />
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="idnum">ID Number:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="idnum" name="idnum">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="idnum">Alternative Number:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="idnum" name="idnum">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="fname">First name:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="fname" name="fname">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="mname">Middle name:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="mname" name="mname">
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="lname">Last name:</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" id="lname" name="lname">
            </div>
          </div>
          <div class="row mb-3">
          <label class="col-sm-2 col-form-label" for="gender">Gender:</label>
            <div class="col-sm-10">
              <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                <input type="radio" class="btn-check" id="btnradio1" name="gender" value="M">
                <label class="btn btn-outline-primary" for="btnradio1">Male</label>
              
                <input type="radio" class="btn-check" id="btnradio2" name="gender" value="F">
                <label class="btn btn-outline-primary" for="btnradio2">Female</label>
              </div>
            </div>
          </div>
          <div class="row mb-3">
          <label class="col-sm-2 col-form-label" for="department">Department:</label>
            <div class="col-sm-10">
              <select class="form-select" aria-label="Default select example" name="department_select">
                {% for item in dept %}
                  <option value="{{item.dept_name}}"> {{ item.dept_name }} </option>
                {% endfor %}
              </select>
            </div>
          </div>
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label" for="department">Course:</label>
              <div class="col-sm-10">
                <select class="form-select" aria-label="Default select example" name="courses" onclick="checkAndAddOption(this)">
                  {% for item in course %}
                    <option value="{{item.course_name}}"> {{ item.course_name }} </option>
                  {% endfor %}
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="department">User Type:</label>
                <div class="col-sm-10">
                  <select class="form-select" aria-label="Default select example" name="usertype_select">
                    {% for item in usertype %}
                      <option value="{{item.usertype_name}}"> {{ item.usertype_name }} </option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="row mb-3">
                <label class="col-sm-2 col-form-label" for="department">Comment:</label>
                  <div class="col-sm-10">
                    <div class="form-floating">
                      <textarea class="form-control" placeholder="Leave a comment here" id="floatingTextarea" name="comments"></textarea>
                      <label for="floatingTextarea">Comments</label>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="d-grid col-4 mx-auto">
                    <button class="btn-cancel " type="submit">Cancel</button>
                  </div>
                  <div class="d-grid col-4 mx-auto">
                    <button class="btn btn-primary" type="submit">Save</button>
                  </div>
                </div>
        </form>
        
      </div>
      <div class="panel" id="three-panel">
        <!-- <div class="panel-title">Note on Prerequisites</div> -->
        <div class="row mb-3">
          <form action="/admin/dashboard/updaterecord/" method="post" name="add_college_form">
            {% csrf_token %}
          <div class="input-group">
            <label class="col-sm-2 col-form-label" for="college">Add a College:</label>
            <input type="text" class="form-control" value="College of " aria-label="College of" aria-describedby="basic-addon2" name="college">
            <div class="input-group-button">
              <button class="btn-update btn-outline-secondary" type="submit">Add</button>
            </div>
          </div>   
          </form>  
        </div>
        <form method="post" name="update_college_form"> 
          {% csrf_token %}
          <div class="row mb-3">
            <div class="input-group">
            <label class="col-sm-2 col-form-label" for="department">Update a College:</label>
              <select class="form-select" aria-label="Default select example" name="college_name">
                {% for item in data %}
                  <option value="{{item.college_name}}"> {{ item.college_name }} </option>
                {% endfor %}
              </select>
            </div>
          </div>
          <div class="row mb-3">
            <div class="input-group">
              <label class="col-sm-2 col-form-label" for="fname">New College Name:</label>
              <input type="text" class="form-control" value="College of " aria-label="College of" aria-describedby="basic-addon2" name="new_college_name">
              <div class="input-group-button">
                <button class="btn-update btn-outline-secondary" type="submit">Update</button>
              </div>
            </div>     
          </div>
        </form>
        <div class="row mb-3">
          <form method="post">
            {% csrf_token %}
            <div class="input-group">
              <label class="col-sm-2 col-form-label" for="delete_college">Delete a College:</label>
              <select class="custom-select" name="delete_college">
                {% for item in data %}
                  <option value="{{item.college_name}}"> {{ item.college_name }} </option>
                {% endfor %}
              </select>
              <div class="input-group-button">
                <button class="btn-delete btn-outline-secondary" type="submit">Delete</button>
              </div>
            </div>
          </form>
          </div>
          {% if messages %}
          <p class="messages">
              {% for message in messages %}
              <p style="color: red; text-align: center; font-weight: bold;" {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message.message }}</p>
              {% endfor %}
          </p>
          {% endif %}
        </div>
   
      <div class="panel" id="four-panel">
        <!-- <div class="panel-title">Note on Prerequisites</div> -->
        <form method="post">
          {% csrf_token %}
          <div class="row mb-3">
            <div class="input-group">
              <label class="col-sm-2 col-form-label" for="dept">Add a Department:</label>
              <input type="text" class="form-control" value="Department of " aria-label="Department of" aria-describedby="basic-addon2" name="dept">
              <div class="input-group-button">
                <button class="btn-update btn-outline-secondary" type="submit">Add</button>
              </div>
            </div>     
          </div>
          <div class="row mb-3">
            <div class="input-group">
            <label class="col-sm-2 col-form-label" for="department">From College of:</label>
                <select class="form-select" aria-label="Default select example" name="from_college">
                {% for item in data %}
                  <option value="{{item.college_name}}"> {{ item.college_name }} </option>
                {% endfor %}
                </select>
            </div>
          </div>
        </form>
        <form method="post"> 
          {% csrf_token %}
        <div class="row mb-3">
          <div class="input-group">
          <label class="col-sm-2 col-form-label" for="department">Update a Department:</label>
              <select class="form-select" aria-label="Default select example" name="update_dept_form">
                {% for item in dept %}
                  <option value="{{item.dept_name}}"> {{ item.dept_name }} </option>
                {% endfor %}
              </select>
          </div>
        </div>
        <div class="row mb-3">
          <div class="input-group">
            <label class="col-sm-2 col-form-label" for="fname">New department Name:</label>
            <input type="text" class="form-control" value="Department of " aria-label="Department of" aria-describedby="basic-addon2" name="new_dept_name">
            <div class="input-group-button">
              <button class="btn-update btn-outline-secondary" type="submit">Update</button>
            </div>
          </div>     
        </div>
      </form>
      <form method="post">
        {% csrf_token %}
        <div class="row mb-3">
          <div class="input-group">
            <label class="col-sm-2 col-form-label" for="delete_dept">Delete a Department:</label>
            <select class="custom-select" id="inputGroupSelect04" name="delete_dept">
              {% for item in dept %}
                <option value="{{item.dept_name}}"> {{ item.dept_name }} </option>
              {% endfor %}
            </select>
            <div class="input-group-button">
              <button class="btn-delete btn-outline-secondary" type="submit">Delete</button>
            </div>
          </div>
          </div>
        </form>
        </div>
      
      <div class="panel" id="five-panel">
        <!-- <div class="panel-title">Note on Prerequisites</div> -->
        <form method="post">
        {% csrf_token %}
          <div class="row mb-3">
            <div class="input-group">
              <label class="col-sm-2 col-form-label" for="fname">Add User Type</label>
              <input type="text" class="form-control" placeholder="" aria-label="College of" aria-describedby="basic-addon2" name="usertype">
              <div class="input-group-button">
                <button class="btn-update btn-outline-secondary" type="submit">Add</button>
              </div>
            </div>     
          </div>
        </form>
        <div class="d-flex justify-content-center">
          <table class="table table-striped table-bordered table-hover">
            <thead class="thead-dark">
              <tr class="text-center">
                <th>User ID</th>
                <th>User Type</th>
              </tr>
            </thead>
            <tbody>
              {% for item in usertype %}
              <tr>
                <td>{{item.type_id}}</td>
                <td>{{item.type_name}}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>        
      </div>
      </div>
    </div>


<script>
document.addEventListener("keydown", function(event) {
    if (document.getElementById("user_input").value != "") {
      document.getElementById("update_user").submit();
    }
  });
  function checkAndAddOption(selectElement) {
      if (selectElement.value === "") {
        var div1=document.getElementById("inputnew");
        div1.innerHTML="<input type='text' name='courses1' id='courses1'/>";
        
      }
      else {
        var div1=document.getElementById("inputnew");
        div1.innerHTML="";
      }
  }

  searchinput.onfocus = function () {
  department_select.style.display = 'block';
  searchinput.style.borderRadius = "5px 5px 0 0";  
};
for (let option of department_select.options) {
  option.onclick = function () {
    searchinput.value = option.value;
    department_select.style.display = 'none';
    searchinput.style.borderRadius = "5px";
  }
};

searchinput.oninput = function() {
  currentFocus = -1;
  var text = searchinput.value.toUpperCase();
  for (let option of department_select.options) {
    if(option.value.toUpperCase().indexOf(text) > -1){
      option.style.display = "block";
  }else{
    option.style.display = "none";
    }
  };
}
var currentFocus = -1;
searchinput.onkeydown = function(e) {
  if(e.keyCode == 40){
    currentFocus++
   addActive(department_select.options);
  }
  else if(e.keyCode == 38){
    currentFocus--
   addActive(department_select.options);
  }
  else if(e.keyCode == 13){
    e.preventDefault();
        if (currentFocus > -1) {
          /*and simulate a click on the "active" item:*/
          if (department_select.options) department_select.options[currentFocus].click();
        }
  }
}

function addActive(x) {
    if (!x) return false;
    removeActive(x);
    if (currentFocus >= x.length) currentFocus = 0;
    if (currentFocus < 0) currentFocus = (x.length - 1);
    x[currentFocus].classList.add("active");
  }
  function removeActive(x) {
    for (var i = 0; i < x.length; i++) {
      x[i].classList.remove("active");
    }
  }
  
</script>
</div>
{% endblock content %}